---
import { projects } from '../data/projects';
import ProjectCard from '../components/ProjectCard.astro';
---

<!-- Sección de Proyectos -->
<section id="proyectos" class="py-8 bg-transparent dark:bg-gray-900 fade-in">
  <div class="absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80" aria-hidden="true">
    <div class="relative left-[calc(50%-11rem)] aspect-1155/678 w-[36.125rem] -translate-x-1/2 rotate-[30deg]
                bg-gradient-to-tr from-[#cbfbf1] to-[#009689] dark:from-[#1f3a44] dark:to-[#2dd4bf] opacity-30
                sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]"
         style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%,
                                      60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%,
                                      0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)">
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <h2 class="text-5xl py-10 font-bold text-teal-600 dark:text-teal-400 mb-8 text-center font-poppins">Proyectos</h2>

    <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8">
      {projects.map((project) => (
        <ProjectCard 
          src={project.src} 
          alt={project.alt} 
          title={project.title} 
          description={project.description} 
          technologies={project.technologies} 
          github={project.github} 
          demo={project.demo} 
          extra={project.extra || false} 
        />
      ))}
    </div>

    <div class="mt-6 flex justify-center py-12">
      <button id="showMoreBtn" class="inline-flex items-center gap-2 px-3 py-1.5 bg-teal-100 dark:bg-teal-800/50 text-teal-600 dark:text-teal-300 rounded-full hover:bg-teal-200 dark:hover:bg-teal-700/80 transition-colors">
        Ver más proyectos
      </button>
    </div>
  </div>

  <div class="absolute inset-x-0 top-[calc(100%-13rem)] -z-10 transform-gpu overflow-hidden blur-3xl
              sm:top-[calc(100%-30rem)]" aria-hidden="true">
    <div class="relative left-[calc(50%+3rem)] aspect-1155/678 w-[36.125rem] -translate-x-1/2
                bg-gradient-to-tr from-[#cbfbf1] to-[#009689] dark:from-[#1f3a44] dark:to-[#2dd4bf] opacity-30
                sm:left-[calc(50%+36rem)] sm:w-[72.1875rem]"
         style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%,
                                      60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%,
                                      0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)">
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const toggleBtn = document.getElementById("showMoreBtn");
      if (toggleBtn) {
        toggleBtn.addEventListener("click", () => {
          const extraProjects = document.querySelectorAll(".project-card.extra");
          if (extraProjects.length > 0) {
            const areHidden = extraProjects[0].classList.contains("hidden");
            extraProjects.forEach(card => {
              card.classList.toggle("hidden", !areHidden);
            });
            toggleBtn.textContent = areHidden ? "Ocultar proyectos" : "Ver más proyectos";
          }
        });
      } else {
        console.warn('No se encontró el botón #showMoreBtn en el DOM.');
      }
    });
  </script>
</section>